-- malware_sim.lua
-- Simulates malware beacon traffic pattern generation

local beacon_interval = 10  -- seconds
local current_time = 0

-- Simulated packet generator
function generate_packet(time)
  -- Simulate a beacon packet to C2 server
  return {
    timestamp = time,
    src_ip = "192.168.1.50",
    dst_ip = "203.0.113.77",
    protocol = "TCP",
    payload = "malware-beacon",
    info = "Simulated malware beacon"
  }
end

function run_simulation(duration)
  local packets = {}
  for t = 0, duration, beacon_interval do
    table.insert(packets, generate_packet(t))
  end
  return packets
end

packets = run_simulation(60)  -- simulate 1 minute beaconing
return packets

